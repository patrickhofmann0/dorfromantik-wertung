<div class="kampagne-visualizer">
  <svg viewBox="0 0 900 400" class="kampagne-svg">
    <!-- Draw paths first (so they appear behind milestones) -->
    @for (pfad of pfade(); track pfad.vonA + '-' + pfad.nachB) {
      @let posA = getPosition(pfad.vonA);
      @let posB = getPosition(pfad.nachB);
      @if (posA && posB) {
        <line
          [attr.x1]="posA.x + 60"
          [attr.y1]="posA.y + 20"
          [attr.x2]="posB.x + 60"
          [attr.y2]="posB.y + 20"
          class="pfad-linie"
        />
      }
    }

    <!-- Draw milestones -->
    @for (position of meilensteinPositionen; track position.meilenstein) {
      <g>
        <rect
          [attr.x]="position.x"
          [attr.y]="position.y"
          width="120"
          height="40"
          class="meilenstein-box"
        />
        <text
          [attr.x]="position.x + 60"
          [attr.y]="position.y + 25"
          class="meilenstein-text"
          text-anchor="middle"
        >
          {{ position.label }}
        </text>
      </g>
    }
  </svg>

  <!-- Path checkboxes -->
  <div class="pfade-container">
    <h3>Kampagnenfortschritt</h3>
    @for (pfad of pfade(); track pfad.vonA + '-' + pfad.nachB) {
      <div class="pfad-item">
        <h4>
          {{ getMeilensteinLabel(pfad.vonA) }} â†’ {{ getMeilensteinLabel(pfad.nachB) }}
        </h4>
        <div class="checkbox-container">
          @for (index of createArray(pfad.kosten); track index) {
            <label class="checkbox-label">
              <input
                type="checkbox"
                [checked]="isCheckboxChecked(pfad, index)"
                (change)="onCheckboxChange(pfad, index, $any($event.target).checked)"
              />
              <span>{{ index + 1 }}</span>
            </label>
          }
        </div>
        <div class="fortschritt-info">Fortschritt: {{ pfad.fortschritt }} / {{ pfad.kosten }}</div>
      </div>
    }
  </div>
</div>
